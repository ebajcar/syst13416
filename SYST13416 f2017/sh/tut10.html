<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Tutorial Set 10</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css"> 

 	<link rel="stylesheet" type="text/css" href="../css/icons.css" />   
    <link type="text/css" rel="Stylesheet" href="tutorials.css"/>
	<link type="text/css" rel="Stylesheet" href="styles/shCoreDefault.css"/>
	<link type="text/css" rel="Stylesheet" href="styles/shThemeDefault.css"/>	
	<script type="text/javascript" src="scripts/shCore.js"></script>
	<script type="text/javascript" src="scripts/shBrushJScript.js"></script>
	<script type="text/javascript" src="scripts/shBrushXml.js"></script>
	<script type="text/javascript" src="scripts/shBrushCss.js"></script>
	<script type="text/javascript" src="scripts/shBrushBash.js"></script>
	<script type="text/javascript">SyntaxHighlighter.all();</script>

	<style type="text/css">
    :invalid { 
          border-color: #e88;
          -webkit-box-shadow: 0 0 5px rgba(255, 0, 0, .8);
          -moz-box-shadow: 0 0 5px rbba(255, 0, 0, .8);
          -o-box-shadow: 0 0 5px rbba(255, 0, 0, .8);
          -ms-box-shadow: 0 0 5px rbba(255, 0, 0, .8);
          box-shadow:0 0 5px rgba(255, 0, 0, .8);
	</style>	
</head>

<body>
<section class="container">
	
	<h1>Tutorial Set 10</h1>
	<p class="dent"><strong>In this tutorial...</strong></p>
	<ul>
		<li><a href="#e01">Using SED&mdash; A few simple examples</a></li>
		<li><a href="#e02">Using SED&mdash; Global Changes</a></li>
		<li><a href="#e03">Using SED&mdash; Prohibiting the Display</a></li>
		<li><a href="#e04">Exercise: Practise using grep and sed</a></li>
		<li><a href="#e05">Get Comfortable with vi</a></li>
		<li><a href="http://en.wikipedia.org/wiki/Sed" target="_blank">Link:  en.wikipedia.org/wiki/Sed</a></li>
		<li><a href="http://www.gnu.org/software/sed/manual/sed.html" target="_blank">Link:  www.gnu.org/software/sed/manual/sed.html</a></li>
	</ul>
	<p>	Examine the  manual pages  for the command sed, 
		and note the description of any options used in these exercises. Examine the  s/// command.</p>
	<p></p>
	<h2  id="e01">Using SED&mdash; A few simple examples</h2>
	
	
	<p class="highlight-3"><img src="../images/exclamation.png" alt="">&nbsp;<strong>Example 1</strong></p>
	<p>Create a file named teaormilk that contains the following:</p>
	<pre class="brush: css; first-line: 1; highlight: [0];" title="">
India’s tea is good.
tea Red-Label is good.
tea is better than the coffee.
some tea is better than other tea.
</pre>	
	<p>	</p>
	<p class="highlight-4">~/bin$ sed ‘/tea/s//milk/g’ teaormilk</p>			
	<p>Note the results. Examine the manual page for sed and explain the results in your own words.</p>
	

	
	<p class="highlight-3"><img src="../images/exclamation.png" alt="">&nbsp;<strong>Example 2</strong> </p>
	<P>the following command changes all incidents of a comma (,) into a comma followed by a space (, ). Use a database file that has fields delimited by a comma.</p>
	<pre class="brush: bash; first-line: 1; highlight: [0];" title="">
1234:Johnson:Bob
4321:Jones:Jim
5678:Smith:Dave
7777:Brown:Tim
8765:Martin:Peter	
</pre>
	<p class="highlight-4">~/bin$ sed s/,/,\ /g</p>			
	<p>Note the results. Enclose the pattern in single quotes and run it again.  Is there a difference? Why or why not? Examine the manual page for sed and explain the results in your own words.</p>	
	
	
	<p class="highlight-3"><img src="../images/exclamation.png" alt="">&nbsp;<strong>Example 3</strong> </p>
	<p>Create a file that contains the following:</p>
	<pre class="brush: bash; first-line: 1; highlight: [0];" title="">
Memorandum
Date: September 15, 2006
To: All Staff
From: John Smith
Re: Company Picnic
This is a reminder that the annual company picnic will be held this Sunday at Wonderland.

</pre>
	<p>To perform multiple operations on the input precede each operation with the –e (edit) option and quote the strings. For example, to filter for lines containing “Date: “ and “From: “ and replace these without the colon (:), try:</p>
	<p class="highlight-4">~/bin$ sed –e ‘s/Date: /Date /’  -e ‘s/From: /From /’</p>
	<p>To print only the first 10 lines of the input (a replacement for head):</p>
	<p class="highlight-4">~/bin$ sed –n 1,10p</p>
	
	
	<p class="highlight-3"><img src="../images/exclamation.png" alt="">&nbsp;<strong>Other examples</strong> </p>
	<p>A nice thing about the s/// command is that we have a lot of options when it comes to those / operators. If we are performing string substitution and the regex or replacement string has a lot of slashes in it, we can change the separator by specifying a different character after the "s". For example this will replace all occurances of /usr/local with /usr</p>
	<p class="highlight-4">~/bin$ sed -e 's:/usr/local:/usr:g' mylist.txt</p>
	<p>&nbsp;</p>
	<p>To remove HTML tags from a file, you can use the command:</p>
	<p class="highlight-4">~/bin$ sed -e 's/<[^>]*>//g' myfile.html</p>
	<p>a '<' character followed by any number of non-'>' characters, and ending with a >. This will have the effect of matching the shortest possible match, rather than the longest possible one.</p>
	<p>&nbsp;</p>


	
	
	<h2   id="e02">Using SED&mdash; Global Changes</h2>
	<p class="highlight-3"><img src="../images/exclamation.png" alt="">&nbsp;<strong>Example 4</strong> </p>
	<p>Suppose the message that is to be changed contains more than one occurrence of the item to be changed. By default, the result can be different than what was expected, as the following illustrates: </p>
	<p class="highlight-4">~/bin$ echo The tiger cubs will meet this Tuesday at the same time as the meeting last Tuesday | sed 's/Tuesday/Thursday/'<br />
	The tiger cubs will meet this <span class="yel">Thursday</span> at the same time as the meeting last <span class="yel">Tuesday</span><br /> ~/bin$ 
	</p>
	<p>Instead of changing every occurrence of "Tuesday" for "Thursday," the sed editor moves on after finding a change and making it, without reading the whole line. The majority of sed commands function like this. </p>
	<p>In order for every occurrence to be substituted, in the event that more than one occurrence appears on the same line, you specify the action to take place globally: </p>
	<p class="highlight-4">~/bin$ echo The tiger cubs will meet this Tuesday at the same time as the meeting last Tuesday | sed 's/Tuesday/Thursday/<span class="yel">g</span>'<br />
	The tiger cubs will meet this <span class="yel">Thursday</span> at the same time as the meeting last <span class="yel">Thursday</span><br /> ~/bin$ 
	</p>	
	
	
	<h2>Conditional Changes</h2>	
	<p>When you want to make a change if certain conditions are met—for example, following a match of some other data, consider the following text file (sample1): </p>
	<pre class="brush: bash; first-line: 1; highlight: [0];" title="sample1">
one     1
two     1
three   1
one     1
two     1
two     1
three   1
</pre>
<p>Suppose that it would be desirable for "1" to be substituted with "2," but only after the word "two" and not throughout every line. This can be accomplished by specifying that a match is to be found before giving the substitute command: </p>
<p class="highlight-4">~/bin$ sed '/two/ s/1/2/' sample1<br />
one&nbsp;&nbsp;&#x09<br />
two&nbsp;&nbsp;	2<br />
three	1<br />
one&nbsp;&nbsp;	1<br />
two&nbsp;&nbsp;	2<br />
two&nbsp;&nbsp;	2<br />
three	1<br />
~/bin$</p>
<p>And now, to make it even more accurate:  &#x3D6;</p>
<p class="highlight-4">~/bin$ sed '<br />
> /two/ s/1/2/<br />
> /three/ s/1/3/' sample1
<br />
one&nbsp;&nbsp;	1<br />
two&nbsp;&nbsp;	2<br />
three	3<br />
one&nbsp;&nbsp;	1<br />
two&nbsp;&nbsp;	2<br />
two&nbsp;&nbsp;	2<br />
three	3<br />
~/bin$</p>
<p>The following saves the changed output to a new file: </p>
<p class="highlight-4">~/bin$ sed '<br />
> /two/ s/1/2/<br />
> /three/ s/1/3/' sample1 > sample2
<br />
~/bin$</p>
<p>The output file has all the changes incorporated in it that would normally appear on the screen. It can now be viewed with head, cat, or any other similar utility. </p><p>Bear in mind once again that the only thing changed is the display. If you look at the original file, it is the same as it always was. You must save the output to another file to create permanence. It is worth repeating that the fact that changes are not made to the original file is a true blessing in disguise—it lets you experiment with the file without causing any real harm, until you get the right commands working exactly the way you expect and want them to. </p>

<h2  id="e03">Using SED&mdash; Prohibiting the Display </h2>
<p>The default is for sed to display on the screen (or to a file, if so redirected) every line from the original file, whether it is affected by an edit operation or not; the "-n" parameter overrides this action. "-n" overrides all printing and displays no lines whatsoever, whether they were changed by the edit or not.</p> 
<p>For example, to print only lines two through six while making no other editing changes:</p>
<p class="highlight-4">~/bin$ sed -n '2,6p' sample<br />
two&nbsp;&nbsp;	1<br />
three	1<br />
one&nbsp;&nbsp;	1<br />
two&nbsp;&nbsp;	1<br />
two&nbsp;&nbsp;	1<br />
~/bin$</p> 
<p>&nbsp;</p>

<h2  id="e04">Exercise: Practise using grep and sed</h2>

	<p> The datebook file is available on the server in the instructor's public/datafiles directory.  Contains the following records:<p> 
	<pre class="brush: bash; highlight: [0];" title="File name: datebook">
Steve Blenheim:238-923-7366:95 Latham Lane, Easton, PA 83755:11/12/56:20300
Betty Boop:245-836-8357:635 Cutesy Lane, Hollywood, CA 91464:6/23/23:14500
Igor Chevsky:385-375-8395:3567 Populus Place, Caldwell, NJ 23875:6/18/68:23400
Norma Corder:397-857-2735:74 Pine Street, Dearborn, MI 23874:3/28/45:245700
Jennifer Cowan:548-834-2348:583 Laurel Ave., Kingsville, TX 83745:10/1/35:58900
Jon DeLoach:408-253-3122:123 Park St., San Jose, CA 04086:7/25/53:85100
Karen Evich:284-758-2857:23 Edgecliff Place, Lincoln, NB 92743:7/25/53:85100
Karen Evich:284-758-2867:23 Edgecliff Place, Lincoln, NB 92743:11/3/35:58200
Karen Evich:284-758-2867:23 Edgecliff Place, Lincoln, NB 92743:11/3/35:58200
Fred Fardbarkle:674-843-1385:20 Parak Lane, DeLuth, MN 23850:4/12/23:780900
Fred Fardbarkle:674-843-1385:20 Parak Lane, DeLuth, MN 23850:4/12/23:780900
Lori Gortz:327-832-5728:3465 Mirlo Street, Peabody, MA 34756:10/2/65:35200
Paco Gutierrez:835-365-1284:454 Easy Street, Decatur, IL 75732:2/28/53:123500
Ephram Hardy:293-259-5395:235 CarltonLane, Joliet, IL 73858:8/12/20:56700
James Ikeda:834-938-8376:23445 Aster Ave., Allentown, NJ 83745:12/1/38:45000
Barbara Kertz:385-573-8326:832 Ponce Drive, Gary, IN 83756:12/1/46:268500
Lesley Kirstin:408-456-1234:4 Harvard Square, Boston, MA 02133:4/22/62:52600
William Kopf:846-836-2837:6937 Ware Road, Milton, PA 93756:9/21/46:43500
Sir Lancelot:837-835-8257:474 Camelot Boulevard, Bath, WY 28356:5/13/69:24500
Jesse Neal:408-233-8971:45 Rose Terrace, San Francisco, CA 92303:2/3/36:25000
Zippy Pinhead:834-823-8319:2356 Bizarro Ave., Farmount, IL 84357:1/1/67:89500
Arthur Putie:923-835-8745:23 Wimp Lane, Kensington, DL 38758:8/31/69:126000
Popeye Sailor:156-454-3322:945 Bluto Street, Anywhere, USA 29358:3/19/35:22350
Jose Santiago:385-898-8357:38 Fife Way, Abilene, TX 39673:1/5/58:95600
Tommy Savage:408-724-0140:1222 Oxbow Court, Sunnyvale, CA 94087:5/19/66:34200
Yukio Takeshida:387-827-1095:13 Uno Lane, Ashville, NC 23556:7/1/29:5700
Vinh Tranh:438-910-7449:8235 Maple Street, Wilmington, VM 29085:9/23/63:68900
</pre>
 
<ul>
	<li>Using <code>grep</code> or <code>egrep</code>, construct a regular expression to extract appropriate records: 
		<ol start="">
			<li>Print all lines that contain string De.</li>
			<li>Print all lines where the person's first name starts with K.</li>
			<li>Print all lines with either CA or ca. </li>
			<li>Print all lines ending in 500 and the 2 lines before & after each matched line.</li>
			<li>Print all the lines that do not contain 927.</li>
			<li>Print all the lines where birthdays are in April.</li>
			<li>Print all the lines where the phone number is in 832 area code.</li>
			<li>Print all lines containing an uppercase letter, followed by four lowercase letters, a comma, a space, and one uppercase letter.</li>
			<li>Print lines where the last name begins with S. </li>
			<li>Print lines proceeded by a line number where the salary is six figures.</li>
			<li>Print lines containing a 9 followed by a single dash & at least one other digit.</li>
			<li>Print lines containing James or Karen at the beginning of the line.</li>
		</ol>
	</li>
	<li>Using <code>sed</code>, construct a regular expression to extract or modify appropriate records: 
		<ol start="13">
			<li>Change name Fred to Frederick</li>
			<li>Delete the first four lines.</li>
			<li>Print lines 7 through 14.</li>
			<li>Delete lines containing Place.</li>
			<li>Print all lines where the birthdays are in January or September.</li>
			<li>Replace the line containing Barbara with "Barbara moved to Europe".</li>
			<li>Change norma's birthday to 6/6/56</li>
			<li>Exchange line containing Betty with line containing Lori</li>
			<li>Move the line beginning with Popeye to overwrite the last line of the file.</li>
		</ol>
	</li>	
</ul>
<p>&nbsp;</p>
	<h2   id="e05">Get Comfortable with vi</h2>
	<ul>
	<li>Use vi editor to create a document called exercise and enter the following text:
		<pre class="brush: html; first-line: 1; highlight: [0];" title="">
		To be blank1, you need
		A conception of what you want,
		A blank2 of high quality,
		A confidence to see you through,
		A blank3 on what it takes,
		A consistency in what you do,
		A blank4 of emotional energy, and
		A blank5 to enjoy the process along the way.
		(Source: T. Morris)</pre></li>
	<li>Change your display to show line numbering:	
		<p class="highlight-4">:set number</p>	
	</li>		
	<li>Save the file as success and exit.</li>
	<li>Load the original file exercise into vi editor.	</li>
	<li>Copy the third line starting with 'a blank2 and restore it before the line starting with 'a blank5', using yank (yy) and paste (p)</li>	
	<li>Delete the last three lines of the file exercise by typing
		<p class="highlight-4">:s7,9d</p>Note the results. Undo the change.
	</li>
	<li>Place your cursor on the first line and run the command
		<p class="highlight-4">:4,$s/blank2/character/g</p>Examine the content of the file. What did the command do?
	</li>
	<li>Place your cursor on the first line and find a string of text "blank". Make sure you are in command mode:	
		<p class="highlight-4">:/blank</p>Save the file exercise10 and exit.
	</li>
	<li>Load the file success into the vi editor. Change the words, using regex, <br>	
	'blank1' to 'successful',<br>
'blank2' to 'character',<br>
'blank3' to 'concentration',<br>
'blank4' to 'commitment',<br>
'blank5' to 'capacity'.</li>
	<!--li>	</li>
	<li>	</li>
<p class="highlight-3"><img src="../images/exclamation.png" alt="">&nbsp;<strong>Example 1</strong></p-->

	
</section>
</ul>
</body>
</html>